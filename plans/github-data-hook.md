{"user(login": "username) {\n login\n name\n avatarUrl\n bio\n url\n repositories(first: 100", "ownerAffiliations": ["OWNER], orderBy: {direction: DESC, field: STARGAZERS}) {\n nodes {\n name\n description\n url\n stargazerCount\n forkCount\n primaryLanguage {\n name\n color\n }\n updatedAt\n }\n }\n contributionsCollection(from: $from, to: $to) {\n      contributionCalendar {\n        totalContributions\n        weeks {\n          contributionDays {\n            date\n            contributionCount\n            color\n          }\n        }\n      }\n      totalCommitContributions\n      totalIssueContributions\n      totalPullRequestContributions\n      totalPullRequestReviewContributions\n    }\n  }\n}\n```\n\n## github-api.ts\n\n```typescript\nimport { GraphQLClient } from 'graphql-request';\n\n/**\n * GitHub GraphQL API client\n */\nconst GITHUB_API_URL = 'https://api.github.com/graphql';\n\n/**\n * Create GraphQL client with authentication\n */\nexport function createGitHubClient(token?: string) {\n  const headers: Record<string, string> = {\n    'Content-Type': 'application/json'\n  };\n\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n\n  return new GraphQLClient(GITHUB_API_URL, { headers });\n}\n\n/**\n * GitHub GraphQL queries\n */\nexport const GITHUB_QUERIES = {\n  getUserContributions: `\n    query GetUserContributions($username: String!, $from: DateTime!, $to: DateTime!) {\n user(login: $username) {\n login\n name\n avatarUrl\n bio\n url\n repositories(first: 100, ownerAffiliations: [OWNER], orderBy: {direction: DESC, field: STARGAZERS}) {\n nodes {\n name\n description\n url\n stargazerCount\n forkCount\n primaryLanguage {\n name\n color\n }\n updatedAt\n }\n }\n contributionsCollection(from: $from, to: $to) {\n contributionCalendar {\n totalContributions\n weeks {\n contributionDays {\n date\n contributionCount\n color\n }\n }\n }\n totalCommitContributions\n totalIssueContributions\n totalPullRequestContributions\n totalPullRequestReviewContributions\n }\n }\n }\n ` \n};\n\n/**\n * Fetch user data from GitHub\n */\nexport async function fetchGitHubUser(\n  username: string,\n  token?: string,\n  from?: Date,\n  to?: Date\n) {\n  const client = createGitHubClient(token);\n\n  // Default to last year of contributions\n  const defaultFrom = new Date();\n  defaultFrom.setFullYear(defaultFrom.getFullYear() - 1);\n  const defaultTo = new Date();\n\n  const variables = {\n    username,\n    from: (from || defaultFrom).toISOString(),\n    to: (to || defaultTo).toISOString()\n  };\n\n  try {\n    const data = await client.request(GITHUB_QUERIES.getUserContributions, variables);\n    return data;\n  } catch (error) {\n    console.error('Error fetching GitHub data:', error);\n    throw error;\n  }\n}\n```\n\n## types/github.ts\n\n```typescript\n/**\n * GitHub contribution day data\n */\nexport interface GitHubContributionDay {\n  date: string;\n  contributionCount: number;\n  color: string;\n}\n\n/**\n * GitHub contribution week data\n */\nexport interface GitHubContributionWeek {\n  contributionDays: GitHubContributionDay[];\n}\n\n/**\n * GitHub contribution calendar data\n */\nexport interface GitHubContributionCalendar {\n  totalContributions: number;\n  weeks: GitHubContributionWeek[];\n}\n\n/**\n * GitHub contributions collection data\n */\nexport interface GitHubContributionsCollection {\n  contributionCalendar: GitHubContributionCalendar;\n  totalCommitContributions: number;\n  totalIssueContributions: number;\n  totalPullRequestContributions: number;\n  totalPullRequestReviewContributions: number;\n}\n\n/**\n * GitHub repository language data\n */\nexport interface GitHubRepositoryLanguage {\n  name: string;\n  color: string;\n}\n\n/**\n * GitHub repository data\n */\nexport interface GitHubRepository {\n  name: string;\n  description: string | null;\n  url: string;\n  stargazerCount: number;\n  forkCount: number;\n  primaryLanguage: GitHubRepositoryLanguage | null;\n  updatedAt: string;\n}\n\n/**\n * GitHub user data\n */\nexport interface GitHubUser {\n  login: string;\n  name: string | null;\n  avatarUrl: string;\n  bio: string | null;\n  url: string;\n  repositories: {\n    nodes: GitHubRepository[];\n  };\n  contributionsCollection: GitHubContributionsCollection;\n}\n\n/**\n * Normalized contribution data for 3D terrain\n */\nexport interface NormalizedContributionData {\n  date: string;\n  x: number; // Week index (0-51)\n  y: number; // Day index (0-6)\n  z: number; // Contribution count (height)\n  color: string;\n}\n\n/**\n * GitHub data response\n */\nexport interface GitHubDataResponse {\n  user: GitHubUser;\n}\n```\n\n## useGithubData.ts\n\n```typescript\nimport { useState, useEffect, useCallback } from 'react';\nimport { fetchGitHubUser } from '@/lib/github-api';\nimport type {\n  GitHubUser,\n  NormalizedContributionData,\n  GitHubRepository\n} from '@/types/github';\n\ninterface UseGithubDataOptions {\n  username: string;\n  token?: string;\n  from?: Date;\n  to?: Date;\n  enabled?: boolean;\n}\n\ninterface UseGithubDataReturn {\n  user: GitHubUser | null;\n  repositories: GitHubRepository[];\n  contributions: NormalizedContributionData[];\n  totalContributions: number;\n  isLoading: boolean;\n  error: Error | null;\n  refetch: () => Promise<void>;\n}\n\n/**\n * Custom hook to fetch and normalize GitHub contribution data\n *\n * Features:\n * - Fetches user profile and contribution data\n * - Normalizes contribution data for 3D terrain visualization\n * - Caches data to prevent unnecessary refetches\n * - Handles loading and error states\n * - Provides refetch functionality\n *\n * @param options - Hook configuration options\n * @returns GitHub data and state\n */\nexport function useGithubData(options: UseGithubDataOptions): UseGithubDataReturn {\n  const { username, token, from, to, enabled = true } = options;\n\n  const [user, setUser] = useState<GitHubUser | null>(null);\n  const [repositories, setRepositories] = useState<GitHubRepository[]>([]);\n  const [contributions, setContributions] = useState<NormalizedContributionData[]>([]);\n  const [totalContributions, setTotalContributions] = useState<number>(0);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  /**\n   * Normalize contribution data for 3D terrain\n   * Converts GitHub contribution calendar to voxel terrain format\n   */\n  const normalizeContributions = useCallback(\n    (data: GitHubUser): NormalizedContributionData[] => {\n      const normalized: NormalizedContributionData[] = [];\n      const { contributionCalendar } = data.contributionsCollection;\n\n      contributionCalendar.weeks.forEach((week, weekIndex) => {\n        week.contributionDays.forEach((day, dayIndex) => {\n          if (day.contributionCount > 0) {\n            normalized.push({\n              date: day.date,\n              x: weekIndex,\n              y: dayIndex,\n              z: day.contributionCount,\n              color: day.color\n            });\n          }\n        });\n      });\n\n      return normalized;\n    },\n    []\n  );\n\n  /**\n   * Fetch GitHub data\n   */\n  const fetchData = useCallback(async () => {\n    if (!enabled || !username) return;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetchGitHubUser(username, token, from, to);\n      const userData = response.user;\n\n      setUser(userData);\n      setRepositories(userData.repositories.nodes);\n      setTotalContributions(\n        userData.contributionsCollection.contributionCalendar.totalContributions\n      );\n      setContributions(normalizeContributions(userData));\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Failed to fetch GitHub data'));\n      console.error('GitHub data fetch error:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [username, token, from, to, enabled, normalizeContributions]);\n\n  /**\n   * Refetch data\n   */\n  const refetch = useCallback(async () => {\n    await fetchData();\n  }, [fetchData]);\n\n  /**\n   * Fetch data on mount and when dependencies change\n   */\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  return {\n    user,\n    repositories,\n    contributions,\n    totalContributions,\n    isLoading,\n    error,\n    refetch\n  };\n}\n\n/**\n * Hook to get contribution statistics\n */\nexport function useGithubStats(options: UseGithubDataOptions) {\n  const { user, isLoading, error } = useGithubData(options);\n\n  const stats = {\n    totalCommits: user?.contributionsCollection.totalCommitContributions || 0,\n    totalIssues: user?.contributionsCollection.totalIssueContributions || 0,\n    totalPullRequests:\n      user?.contributionsCollection.totalPullRequestContributions || 0,\n    totalReviews:\n      user?.contributionsCollection.totalPullRequestReviewContributions || 0,\n    totalRepositories: user?.repositories.nodes.length || 0,\n    totalStars:\n      user?.repositories.nodes.reduce((sum, repo) => sum + repo.stargazerCount, 0) || 0,\n    totalForks:\n      user?.repositories.nodes.reduce((sum, repo) => sum + repo.forkCount, 0) || 0\n  };\n\n  return {\n    stats,\n    isLoading,\n    error\n  };\n}\n\n/**\n * Hook to get top repositories\n */\nexport function useTopRepositories(options: UseGithubDataOptions, limit: number = 6) {\n  const { repositories, isLoading, error } = useGithubData(options);\n\n  const topRepositories = repositories\n    .sort((a, b) => b.stargazerCount - a.stargazerCount)\n    .slice(0, limit);\n\n  return {\n    repositories: topRepositories,\n    isLoading,\n    error\n  };\n}\n```\n\n## Usage Examples\n\n### Basic Usage\n\n```typescript\n'use client';\n\nimport { useGithubData } from '@/hooks/useGithubData';\n\nexport function GitHubProfile() {\n  const { user, contributions, totalContributions, isLoading, error } = useGithubData({\n    username: 'your-username',\n    token: process.env.NEXT_PUBLIC_GITHUB_TOKEN\n  });\n\n  if (isLoading) return <div>Loading...</div>;\n  if (error) return <div>Error: {error.message}</div>;\n\n  return (\n    <div>\n      <h1>{user?.name || user?.login}</h1>\n      <p>Total Contributions: {totalContributions}</p>\n      <p>Contribution Days: {contributions.length}</p>\n    </div>\n  );\n}\n```\n\n### Using with 3D Terrain\n\n```typescript\n'use client';\n\nimport { useGithubData } from '@/hooks/useGithubData';\nimport { GitHubTerrain } from '@/components/canvas/GitHubTerrain';\n\nexport function GitHubSection() {\n  const { contributions, isLoading } = useGithubData({\n    username: 'your-username',\n    token: process.env.NEXT_PUBLIC_GITHUB_TOKEN\n  });\n\n  if (isLoading) return <div>Loading terrain...</div>;\n\n  return (\n    <div className=\"h-screen", "GitHubTerrain contributions={contributions} />\n    </div>\n  );\n}\n```\n\n### Using Statistics\n\n```typescript\n'use client';\n\nimport { useGithubStats } from '@/hooks/useGithubData';\n\nexport function GitHubStats() {\n  const { stats, isLoading } = useGithubStats({\n    username: 'your-username'\n  });\n\n  if (isLoading) return <div>Loading stats...</div>;\n\n  return (\n    <div className=\"grid grid-cols-2 gap-4\">\n      <div className=\"glass-panel", "h3>Commits</h3>\n        <p>{stats.totalCommits}</p>\n      </div>\n      <div className=\"glass-panel", "h3>Pull Requests</h3>\n        <p>{stats.totalPullRequests}</p>\n      </div>\n      <div className=\"glass-panel", "h3>Issues</h3>\n        <p>{stats.totalIssues}</p>\n      </div>\n      <div className=\"glass-panel", "h3>Reviews</h3>\n        <p>{stats.totalReviews}</p>\n      </div>\n    </div>\n  );\n}\n```\n\n### Using Top Repositories\n\n```typescript\n'use client';\n\nimport { useTopRepositories } from '@/hooks/useGithubData';\n\nexport function TopProjects() {\n  const { repositories, isLoading } = useTopRepositories(\n    {\n      username: 'your-username'\n    },\n    6\n  );\n\n  if (isLoading) return <div>Loading projects...</div>;\n\n  return (\n    <div className=\"grid grid-cols-3 gap-4", {"className=\"glass-panel": "h3>{repo.name"}, "h3>\n          <p>{repo.description}</p>\n          <div className=\"flex gap-2", "span>\u2b50 {repo.stargazerCount}</span>\n            <span>\ud83c\udf74 {repo.forkCount}</span>\n          </div>\n          {repo.primaryLanguage && (\n            <div className=\"flex items-center gap-2\">\n              <div\n                className=\"w-3 h-3 rounded-full", "style={{ backgroundColor: repo.primaryLanguage.color }}\n              />\n              <span>{repo.primaryLanguage.name}</span>\n            </div>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n}\n```\n\n## Environment Variables\n\nCreate a  `.env.local` file:\n\n`env\nNEXT_PUBLIC_GITHUB_USERNAME=your-username\nNEXT_PUBLIC_GITHUB_TOKEN=ghp_your_token_here\n`\n\n## Performance Considerations\n\n1. **Caching**: The hook caches data to prevent unnecessary refetches\n2. **Debouncing**: Consider debouncing refetch calls in production\n3. **Error Handling**: Proper error handling prevents UI crashes\n4. **Loading States**: Show loading indicators during data fetch\n5. **Token Usage**: Use a personal access token for higher rate limits\n\n## Rate Limits\n\nGitHub GraphQL API has rate limits:\n- **Without token**: 60 requests per hour\n- **With token**: 5,000 requests per hour\n\nAlways use a token in production to avoid rate limiting.\n\n## Data Normalization\n\nThe hook normalizes GitHub contribution data into a format suitable for 3D terrain visualization:\n\n- **x**: Week index (0-51) - horizontal position\n- **y**: Day index (0-6) - vertical position\n- **z**: Contribution count - height/depth\n- **color**: GitHub's contribution color\n\nThis format allows easy mapping to 3D voxels in the terrain visualization."]}
